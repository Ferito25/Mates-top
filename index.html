<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Test de Matemáticas 1º Primaria</title>
<style>
  body { font-family: Arial, sans-serif; margin: 20px; }
  select, button, input { padding: 8px; margin: 5px 0; font-size: 16px; }
  .pregunta { margin: 10px 0; }
  .correcto { color: green; }
  .error { color: red; }
</style>
</head>
<body>

<h1>Test de Matemáticas 1º Primaria</h1>

<label for="curso">Curso:</label><br />
<select id="curso">
  <option value="1primaria" selected>1º Primaria</option>
</select><br/>

<label for="tema">Tema:</label><br />
<select id="tema">
  <option value="Números hasta el 100">Números hasta el 100</option>
  <option value="Sumas y restas">Sumas y restas</option>
</select><br/>

<label for="modo">Tipo de preguntas:</label><br />
<select id="modo">
  <option value="mix">Mixto</option>
  <option value="solo">Solo sobre tema seleccionado</option>
</select><br/>

<button id="btnGenerar">Generar Test</button>

<div id="testArea"></div>

<button id="btnCorregir" style="display:none;">Corregir Test</button>

<script>
  const API_URL = "https://subsequent-faceted-marlin.glitch.me"; // Cambia por tu URL real

  const btnGenerar = document.getElementById("btnGenerar");
  const btnCorregir = document.getElementById("btnCorregir");
  const testArea = document.getElementById("testArea");
  const cursoSelect = document.getElementById("curso");
  const temaSelect = document.getElementById("tema");
  const modoSelect = document.getElementById("modo");

  let preguntasActuales = [];

  btnGenerar.onclick = async () => {
    const curso = cursoSelect.value;
    const tema = temaSelect.value;
    // modo lo usaremos más adelante si quieres
    testArea.innerHTML = "Generando preguntas...";

    try {
      const res = await fetch(`${API_URL}?curso=${curso}&tema=${tema}`);
      if (!res.ok) throw new Error("Error en la petición");
      const data = await res.json();

      preguntasActuales = data.preguntas || [];

      if (preguntasActuales.length === 0) {
        testArea.innerHTML = "No se generaron preguntas.";
        btnCorregir.style.display = "none";
        return;
      }

      // Mostrar preguntas con input
      let html = "";
      preguntasActuales.forEach((p, i) => {
        html += `
          <div class="pregunta">
            <b>Pregunta ${i+1}:</b> ${p.pregunta} <br/>
            <input type="text" id="respuesta-${i}" />
            <span id="feedback-${i}"></span>
          </div>
        `;
      });
      testArea.innerHTML = html;
      btnCorregir.style.display = "inline-block";
    } catch (e) {
      testArea.innerHTML = "Error al generar el test.";
      btnCorregir.style.display = "none";
      console.error(e);
    }
  };

  btnCorregir.onclick = () => {
    preguntasActuales.forEach((p, i) => {
      const userResp = document.getElementById(`respuesta-${i}`).value.trim();
      const feedback = document.getElementById(`feedback-${i}`);

      if (userResp === p.respuesta) {
        feedback.textContent = " ¡Correcto!";
        feedback.className = "correcto";
      } else {
        feedback.textContent = ` Incorrecto. La respuesta correcta es ${p.respuesta}`;
        feedback.className = "error";
      }
    });
  };
</script>

</body>
</html>









